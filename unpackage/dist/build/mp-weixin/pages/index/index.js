(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"306c":function(e,t,n){},3757:function(e,t,n){"use strict";var o={uniHeader:function(){return n.e("components/uni-header/uni-header").then(n.bind(null,"681c"))}},c=function(){var e=this,t=e.$createElement;e._self._c},i=[];n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}))},"3e54":function(e,t,n){"use strict";(function(e){n("4c46");o(n("66fd"));var t=o(n("d265"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},7159:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=c(n("0c60"));c(n("da1a"));function c(e){return e&&e.__esModule?e:{default:e}}var i={data:function(){return{title:"首页",zhName:"于都县",shNums:1,citydata:"",scrollerHeight:""}},onLoad:function(){},mounted:function(){this.barheight=this.$store.state.barHeight;var e=this;console.log(this.openId),e.getHeight(),e.getlocation()},methods:{getHeight:function(){var t=this,n=e.createSelectorQuery().in(this);n.select("#wrap").boundingClientRect((function(e){t.scrollerHeight=e.height})).exec(),t.$nextTick((function(){n.select("#header").boundingClientRect((function(e){t.scrollerHeight=t.scrollerHeight-e.height})).exec()})),t.$nextTick((function(){n.select("#msg_box").boundingClientRect((function(e){t.scrollerHeight=t.scrollerHeight-e.height})).exec()})),t.$nextTick((function(){n.select("#admin_box").boundingClientRect((function(e){t.scrollerHeight=t.scrollerHeight-e.height+"px"})).exec()}))},getlocation:function(){var t=this;e.getLocation({type:"gcj02",success:function(n){var o=t;n.latitude,n.longitude;console.log(n),e.request({header:{"Content-Type":"application/text"},url:"https://restapi.amap.com/v3/geocode/regeo?output=JSON&location="+n.longitude+","+n.latitude+"&key=280802ed0116fef931dbcf5e7e9278d7&radius=1000&extensions=all",success:function(t){var n=this;console.log(t),200===t.statusCode?(o.citydata=t.data.regeocode.addressComponent.city,e.request({url:"http://wthrcdn.etouch.cn/weather_mini?city=重庆",method:"GET",success:function(e){console.log(e.data.data.wendu),n.cylinderEmpty.temperature=Math.round(e.data.data.wendu)},fail:function(){n.openmsg("警告","天气接口获取失败")},complete:function(){}})):console.log("获取信息失败，请重试！")}})}})},toMsg:function(){e.navigateTo({url:"/pages/msgList/msgList"})},toUser:function(){e.navigateTo({url:"/pages/user/user"}),this.openDY()},getOpenId:function(){var t=this,n=this;n.$showLoading(),e.getStorageSync("openId")?(console.log(2),n.openId=e.getStorageSync("openId"),n.getRole()):e.login({provider:"weixin",success:function(c){console.log("登录成功：",c),t.Code=c.code,console.log(c),e.request({url:o.default.baseUrl+"/GetOpenId?js_code="+c.code+"&tdsourcetag=s_pcqq_aiomsg",method:"post",success:function(t){e.setStorageSync("openId",t.data.openid),n.openId=e.getStorageSync("openId"),n.getRole()}})},fail:function(e){console.log("登录失败：",e)}})},getRole:function(){var t=this;e.request({url:o.default.baseUrl+"/LoginByOpenId",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{openId:t.openId},method:"POST",success:function(n){console.log(n.data),"200"==n.data.StatusCode?(t.$store.commit("login",n.data.JESSIONID),t.$store.commit("setUser",n.data.USERNAME),t.$store.commit("setPhone",n.data.PHONE),t.$store.commit("setUserId",n.data.USERID),t.openId=e.getStorageSync("openId"),t.zhName=e.getStorageSync("zhName"),t.userId=e.getStorageSync("userId"),t.avatarUrl=e.getStorageSync("avatarUrl")):(t.$toast(n.data.Message),setTimeout((function(){e.reLaunch({url:"../login/login"})}),1e3))},fail:function(t){console.log(t),e.showToast({icon:"none",title:"请求出错: "+t,duration:2e3})}})},openDY:function(){var e=this;wx.getSetting({withSubscriptions:!0,success:function(t){if(t.subscriptionsSetting.mainSwitch)if(null!=t.subscriptionsSetting.itemSettings){var n=t.subscriptionsSetting.itemSettings["ThgIlxwPDhqXL1hbqbH9xzSm92Re4ZBGn0e1O0-FPmA"];console.log(n),"accept"===n?(console.log("接受了消息推送"),wx.requestSubscribeMessage({tmplIds:["ThgIlxwPDhqXL1hbqbH9xzSm92Re4ZBGn0e1O0-FPmA"],success:function(t){console.log("订阅消息 成功 "),console.log(t),"accept"==t["ThgIlxwPDhqXL1hbqbH9xzSm92Re4ZBGn0e1O0-FPmA"]&&e.dyNums()},fail:function(e){console.log("订阅消息 失败 "),console.log(e)}})):"reject"===n?console.log("拒绝消息推送"):"ban"===n&&console.log("已被后台封禁")}else wx.showModal({title:"提示",content:"请授权开通服务通知",showCancel:!0,success:function(t){t.confirm&&wx.requestSubscribeMessage({tmplIds:["ThgIlxwPDhqXL1hbqbH9xzSm92Re4ZBGn0e1O0-FPmA"],success:function(t){console.log("订阅消息 成功 "),console.log(t),"accept"==t["ThgIlxwPDhqXL1hbqbH9xzSm92Re4ZBGn0e1O0-FPmA"]&&e.dyNums()},fail:function(e){console.log("订阅消息 失败 "),console.log(e)}})}});else console.log("订阅消息未开启")},fail:function(e){console.log(e)}})},zfsb:function(){e.navigateTo({url:"../zfsbSearch/zfsbSearch"})},rhhs:function(){e.navigateTo({url:"../rhhsList/rhhsList"})},yjjc:function(){e.navigateTo({url:"../yjjcList/yjjcList"})},sjtj:function(){e.navigateTo({url:"../sjtjList/sjtjList"})}}};t.default=i}).call(this,n("543d")["default"])},a59a:function(e,t,n){"use strict";n.r(t);var o=n("7159"),c=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=c.a},b1c9:function(e,t,n){"use strict";var o=n("306c"),c=n.n(o);c.a},d265:function(e,t,n){"use strict";n.r(t);var o=n("3757"),c=n("a59a");for(var i in c)"default"!==i&&function(e){n.d(t,e,(function(){return c[e]}))}(i);n("b1c9");var s,a=n("f0c5"),l=Object(a["a"])(c["default"],o["b"],o["c"],!1,null,"cce38a0a",null,!1,o["a"],s);t["default"]=l.exports}},[["3e54","common/runtime","common/vendor"]]]);